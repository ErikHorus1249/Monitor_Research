

## Integrating Check_MK in Grafana via PNP4Nagios data 

## 1. Architecture 


- The graphing system in the  Checkmk Raw Edition is generated by PNP4Nagios von Jörg Linge as a basis for the capturing and visualisation of performance data


## 2. Thực hiện cấu hình 

- Thực hiện cài đặt Plugin PNP4Nagios 
```
grafana-cli plugins install sni-pnp-datasource
systemctl restart grafana-server.service

```

- Trên node check_MK, thực hiện di chuyển vào thư mục pnp4nagios của site
```
OMD_SITE=mysite
cd /omd/sites/$OMD_SITE/share/pnp4nagios/htdocs/application/controllers
wget -O api.php "https://github.com/lingej/pnp-metrics-api/raw/master/application/controller/api.php"

```

- Khởi tạo datasource trên grafana. Lưu ý phần authen sử dụng một tài khoản có Role "Administrator" trên check_MK 
![](https://i.imgur.com/TmCUQlC.png)


- Thêm Datasource có URL dạng "http://xxx/sitename/pnp4nagios
![](https://i.imgur.com/lYP4EpI.png)